[workspace]
resolver = "2"
members = [
    "crates/flui_types",        # Base types - no dependencies
    "crates/flui_core",         # Core with foundation utilities
    "crates/flui_rendering",
    "crates/flui_widgets",
    "crates/flui_app",          # Application framework
    # "crates/flui_painting",
    # "crates/flui_animation",
    # "crates/flui_gestures",
    # "crates/flui_scheduler",
    # "crates/flui_platform",
    # "crates/flui_provider",
]

[workspace.package]
version = "0.1.0"
edition = "2021"
rust-version = "1.75"
license = "MIT OR Apache-2.0"
authors = ["Flui Contributors"]
repository = "https://github.com/yourusername/flui"

[workspace.dependencies]
# CORE EGUI & PLATFORM (v0.33 - latest)
egui = { version = "0.33", features = ["default", "serde"] }
eframe = { version = "0.33", default-features = false, features = ["default_fonts", "glow", "persistence", "wayland", "x11"] }
egui_extras = { version = "0.33", features = ["image", "svg", "file"] }

# ASYNC RUNTIME
tokio = { version = "1.40", features = ["full", "rt-multi-thread", "macros", "sync", "time"] }
async-trait = "0.1"
futures = "0.3"

# SYNCHRONIZATION
parking_lot = "0.12"
once_cell = "1.20"
dashmap = "6.1"
arc-swap = "1.7"

# COLLECTIONS
indexmap = { version = "2.5", features = ["serde"] }
smallvec = { version = "1.13", features = ["serde", "union"] }
slotmap = "1.0"

# SERIALIZATION
serde = { version = "1.0", features = ["derive", "rc"] }
serde_json = "1.0"

# BUILDER UTILITIES
bon = { version = "3.8" }

# ERROR HANDLING & LOGGING
thiserror = "2.0"
anyhow = "1.0"
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter", "fmt"] }

# MATH & GEOMETRY
glam = { version = "0.29", features = ["serde", "bytemuck"] }
ordered-float = "5.1"

# IMAGE PROCESSING
image = { version = "0.25", features = ["png", "jpeg", "gif", "webp"] }
resvg = "0.45"
usvg = "0.45"

# MEMORY & CACHING
lru = "0.16"  # Simple LRU (keep for compatibility)
moka = { version = "0.12", features = ["future"] }  # High-performance cache
bumpalo = "3.16"  # Bump allocator for frame-temp data
typed-arena = "2.0"  # Type-safe arena allocator

# NETWORKING
reqwest = { version = "0.12", features = ["json", "stream", "rustls-tls"] }
url = { version = "2.5", features = ["serde"] }

# UTILITIES
itertools = "0.14.0"
ahash = "0.8"
rustc-hash = "2.0"  # FxHash - faster for small keys
bitflags = "2.9"
dyn-clone = "1.0"
downcast-rs = "2.0.2"
fastrand = "2.0"  # Fast RNG for widget IDs, jitter

# STRING INTERNING
lasso = { version = "0.7", features = ["multi-threaded"] }  # Fast string interning

# OPTIMIZED SMART POINTERS
triomphe = "0.1"  # Arc optimized for immutable data

# SPECIALIZED COLLECTIONS
tinyvec = { version = "1.8", features = ["alloc"] }  # Smaller than SmallVec

# PERFORMANCE & PROFILING
criterion = "0.7"
tracing-tracy = "0.11"  # Tracy profiler integration
puffin_http = "0.16"  # Puffin HTTP server

[package]
name = "flui"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
license.workspace = true
description = "Flutter-inspired declarative UI framework built on egui 0.33"
keywords = ["gui", "ui", "egui", "flutter", "reactive"]

[dependencies]
# Flui crates
flui_app = { path = "crates/flui_app" }
flui_widgets = { path = "crates/flui_widgets" }

# Workspace dependencies
egui.workspace = true
eframe.workspace = true
tokio.workspace = true
serde.workspace = true
tracing.workspace = true
tracing-subscriber.workspace = true

# Optional profiling dependencies
puffin = { version = "0.19", optional = true }
puffin_egui = { version = "0.29", optional = true }
tracing-tracy = { workspace = true, optional = true }
puffin_http = { workspace = true, optional = true }

[dev-dependencies]
criterion.workspace = true

[features]
default = ["persistence"]
persistence = ["eframe/persistence"]
profiling = ["puffin", "puffin_egui", "puffin_http"]
tracy = ["tracing-tracy"]
full-profiling = ["profiling", "tracy"]

[profile.release]
opt-level = 3
lto = "thin"
codegen-units = 1
strip = true
panic = "abort"

[profile.dev]
opt-level = 1

[profile.dev.package."*"]
opt-level = 2
