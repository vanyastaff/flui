[workspace]
resolver = "2"
members = [
    "crates/flui_types",        # Base types - no dependencies
    "crates/flui_assets",       # Asset management system
    "crates/flui_core",         # Core with foundation utilities
    "crates/flui_rendering",
    "crates/flui_widgets",
    "crates/flui_app",
    "crates/flui_painting",
    "crates/flui_engine",       # Rendering engine - Layer/Scene/Painter
    "crates/flui_derive",
    "crates/flui_devtools",
    "crates/flui_gestures",
    "crates/flui_animation",    # Animation system
    # "crates/flui_scheduler",
    # "crates/flui_platform",
    # "crates/flui_provider",
]

[workspace.package]
version = "0.1.0"
edition = "2021"
rust-version = "1.90"
license = "MIT OR Apache-2.0"
authors = ["Flui Contributors"]
repository = "https://github.com/yourusername/flui"

[workspace.dependencies]
# ASYNC RUNTIME (Stable: 1.43 LTS - March 2026)
tokio = { version = "1.43", features = ["full"] }
futures = "0.3"

# SYNCHRONIZATION - Used by multiple crates
parking_lot = "0.12"
once_cell = "1.20"

# COLLECTIONS - Used by multiple crates
smallvec = { version = "1.13", features = ["serde", "union"] }

# SERIALIZATION - Core functionality
serde = { version = "1.0", features = ["derive", "rc"] }
serde_json = "1.0"

# BUILDER UTILITIES - Used by widgets
bon = "3.8"

# ERROR HANDLING & LOGGING - Used everywhere
thiserror = "2.0"
anyhow = "1.0"
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter", "fmt", "ansi"] }
tracing-tree = "0.4"

# MATH & GEOMETRY - Core rendering math
glam = { version = "0.30", features = ["serde", "bytemuck"] }

# IMAGE PROCESSING - Used by flui_types and flui_engine
image = { version = "0.25", features = ["png", "jpeg", "gif", "webp"] }

# GPU RENDERING (WGPU BACKEND)
wgpu = { version = "25.0", features = ["wgsl"] }
winit = "0.30.10"
bytemuck = { version = "1.18", features = ["derive"] }
glyphon = "0.9"
cosmic-text = "0.14"
guillotiere = "0.6"
lyon = "1.0"
ttf-parser = "0.25"
pollster = "0.3"

# CACHING - Used by flui_core and flui_assets
moka = { version = "0.12", features = ["future"] }

# NETWORKING - Used by flui_assets
reqwest = { version = "0.12", features = ["json", "stream", "rustls-tls"] }

# UTILITIES - Used by multiple crates
ahash = "0.8"
bitflags = "2.10"
dyn-clone = "1.0"
downcast-rs = "2.0.2"

# STRING INTERNING - Used by flui_assets
lasso = { version = "0.7", features = ["multi-threaded"] }

# OPTIMIZED SMART POINTERS - Used by flui_assets
triomphe = "0.1"

# PERFORMANCE & PROFILING
criterion = "0.7"
tracing-tracy = "0.11"
puffin_http = "0.16"

[package]
name = "flui"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
license.workspace = true
description = "Flutter-inspired declarative UI framework with wgpu rendering"
keywords = ["gui", "ui", "wgpu", "flutter", "reactive"]

[dependencies]
# Flui crates - all included in workspace
flui_types = { path = "crates/flui_types" }
flui_core = { path = "crates/flui_core" }
flui_painting = { path = "crates/flui_painting" }
flui_engine = { path = "crates/flui_engine" }
flui_rendering = { path = "crates/flui_rendering" }
flui_app = { path = "crates/flui_app" }
flui_widgets = { path = "crates/flui_widgets" }

# For wgpu_demo example
parking_lot = { workspace = true }
pollster = { workspace = true }
env_logger = "0.11"
winit = { workspace = true }

# Workspace dependencies
tokio.workspace = true
serde.workspace = true
tracing.workspace = true
tracing-subscriber.workspace = true

# Optional profiling dependencies
puffin = { version = "0.19", optional = true }
tracing-tracy = { workspace = true, optional = true }
puffin_http = { workspace = true, optional = true }

[dev-dependencies]
# criterion only needed in individual crates for benchmarks, not in root

[features]
default = []

# === Core Features ===
# Serialization support across all crates
serde = [
    "flui_core/serde",
    "flui_types/serde",
    "flui_rendering/serde",
]

# === Performance Features ===
# Multi-threaded parallel processing
parallel = ["flui_core/parallel"]

# === Profiling & Debug Features ===
# Basic profiling with puffin
profiling = ["puffin", "puffin_http", "flui_core/profiling"]

# Tracy profiler integration (for production profiling)
tracy = ["tracing-tracy"]

# All profiling features combined
full-profiling = ["profiling", "tracy"]

# === DevTools Features ===
# Developer tools integration
devtools = ["flui_engine/devtools"]

# Memory profiling
memory-profiler = ["devtools", "flui_engine/memory-profiler"]

# === Convenience Features ===
# Enable all stable features (excludes experimental)
full = ["serde", "parallel", "profiling", "devtools"]

[profile.release]
opt-level = 3
lto = "thin"
codegen-units = 1
strip = true
panic = "abort"

[profile.dev]
opt-level = 1

[profile.dev.package."*"]
opt-level = 2

